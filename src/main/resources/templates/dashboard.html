<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity6">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard â€” MyRabbitry</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Marcellus&family=Nunito:wght@400;600;700;800&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="/css/styles.css">
    <link rel="icon" href="/images/logo.png">
</head>

<body>
    <div class="parent-content-box">
        <div class="dashboard">
            <aside class="sidebar">
                <div class="brand">
                    <img src="/images/logo.png" alt="MyRabbitry logo" class="logo">
                    <span class="brand-name">MyRabbitry</span>
                </div>
                <ul class="nav-list">
                <li><a href="/dashboard" class="active">Profile</a></li>
                <li><a href="/rabbits/me">My Rabbits</a></li>
                <li><a href="/overview">Overview</a></li>
                <li><a href="/pregnancies">Maternity Ward</a></li>
                <li><a href="/pregnancies/details">Pregnancy Reports</a></li>
                <li><a href="/family-tree">Family Tree</a></li>
                <li><a href="/subscriptions">Subscription</a></li>
                <li sec:authorize="hasRole('ADMIN')"><a href="/admin/panel">Admin Panel</a></li>
                <li sec:authorize="hasRole('ADMIN')"><a href="/admin/reports/profit">Profit Reports</a></li>
                <li><a href="/logout" id="logoutBtn">Log out</a></li>
                </ul>
            </aside>
        </div>

        <div class="dashboard-content">

            <div class="profile-box">
                <div class="profile-header">
                    <img th:src="${#strings.isEmpty(user.profilePicture) ? '/images/Windows_10_Default_Profile_Picture.svg.png' : user.profilePicture}"
                        alt="Profile Picture" class="profile-picture">
                    <div class="profile-status-username">
                        <h2 class="profile-username" th:text="${user.username}">Hello Monika123</h2>
                        <p th:if="${user.isActive}" class="profile-status-active">ACTIVE</p>
                         <p th:if="${!user.isActive}" class="profile-status-inactive">INACTIVE</p>
                    </div>
                </div>
                <div class="profile-info">
                    <div class="profile-details-container">
                        <strong>First Name: </strong>
                        <p th:text="${#strings.isEmpty(user.firstName) ? 'n/a' : user.firstName}">Jhon</p>
                    </div>
                    <div class="profile-details-container">
                        <strong>User id: </strong>
                        <p th:text="${user.id}">1234567adfsfdf4-cggtybr34-t434y</p>
                    </div>
                    <div class="profile-details-container">
                        <strong>Last Name: </strong>
                        <p th:text="${#strings.isEmpty(user.lastName) ? 'n/a' : user.lastName}">Hills</p>
                    </div>
                    <div class="profile-details-container">
                        <strong>Joined on: </strong>
                        <p th:text="${#temporals.format(user.createdOn, 'dd MMM YYYY HH:mm')}">12 NOV 1980 09:27</p>
                    </div>
                </div>
                <a th:href="@{'/users/' + ${user.id} + '/profile'}" class="btn profile-btn">
                    <p>Edit Profile</p>
                </a>
            </div>

            <h3 class="align-rabbit-box">Latest added rabbit</h3>

            <div class="rabbit-box">
                <div class="rabbit-main-info" th:unless="${latestRabbit == null}">
                    <img th:src="${#strings.isEmpty(latestRabbit.photoUrl) ? '/images/logo.png' : latestRabbit.photoUrl}" alt="Rabbit Picture" class="rabbit-picture">
                    <div class="code-name-box">
                        <p th:text="'code: ' + ${latestRabbit.code}">code: 91-ga</p>
                        <p th:text="'Name: ' + ${#strings.isEmpty(latestRabbit.name) ? 'n/a' : latestRabbit.name}">Name: Tricky</p>
                    </div>
                </div>
                <div class="rabbit-secondary-info" th:unless="${latestRabbit == null}">
                    <div class="rabbit-label">
                        <strong>id:</strong>
                        <strong>birthdate:</strong>
                        <strong>sex:</strong>
                        <strong>status:</strong>
                    </div>

                    <div class="rabbit-data">
                        <p th:text="${latestRabbit.id}">3dx4c5vbc-vb3245fvddf3rtg-sdf657sdcsd</p>
                        <p th:text="${#strings.isEmpty(latestRabbit.birthDate) ? 'n/a' : #temporals.format(latestRabbit.birthDate, 'dd MMM YYYY')}">27 Nov 2024</p>
                        <p th:text="${latestRabbit.sex.getDisplayName()}">Male</p>
                        <p th:text="${latestRabbit.status.getDisplayName()}">For Breeding</p>
                    </div>
                </div>
                <div class="empty-rabbit-box" th:if="${latestRabbit == null}">
                    <p>No rabbits yet!</p>
                </div>
            </div>

            <div class="pregnancy-box">
                <div class="pregnancy-header" th:unless="${pregnancyReport == null}">
                    <div class="date-box">
                        <h2>Latest pregnancy report due date:</h2>
                        <strong th:text="${#strings.isEmpty(pregnancyReport.earliestDueDate) ? 'n/a' : #temporals.format(pregnancyReport.earliestDueDate, 'dd MMM yyyy')}">12 NOV 2025</strong>
                    </div>
                    <a th:href="@{'/pregnancies/details/' + ${pregnancyReport.id}}" class="btn view-pregnancy-button">
                        <p>More Info</p>
                    </a>
                </div>
                <div class="rabbit-parents" th:unless="${pregnancyReport == null}">
                    <div class="parent-box">
                        <h3>Mother: </h3>
                        <p th:text="'code: ' + ${pregnancyReport.mother.code}">code: 23-fr</p>
                        <p th:text="'name: ' + ${#strings.isEmpty(pregnancyReport.mother.name) ? 'n/a' : pregnancyReport.mother.name}">name: Bella</p>
                        <p th:text="'id: ' + ${pregnancyReport.mother.id}">id: 45vbdf-dghj5vbsvfd-s5f67dfhgf56df</p>
                    </div>
                    <div class="parent-box">
                        <h3>Father: </h3>
                        <p th:text="'code: ' + ${pregnancyReport.father == null ? 'n/a' : pregnancyReport.father.code}">code: 28-ed</p>
                        <p th:text="'name: ' + ${pregnancyReport.father == null || #strings.isEmpty(pregnancyReport.father.name) ? 'n/a' : pregnancyReport.father.name}">name: Max</p>
                        <p th:text="'id: ' + ${pregnancyReport.father == null ? 'n/a' : pregnancyReport.father.id}">id: lp235dvss-456hjvbsvfd-3xcf6567vbn56b67n</p>
                    </div>
                </div>
                <div class="empty-rabbit-box" th:if="${pregnancyReport == null}">
                    <p>No Pregnancy reports yet!</p>
                </div>
            </div>

            <h3 class="align-subscription-box">Subscription</h3>

            <div class="subscription-box">
                <strong th:text="${user.subscriptions.get(0).type.getDisplayName()}">family hobby farm</strong>
                <div class="subscription-info">
                    <p th:text="'valid from: ' + ${#temporals.format(user.subscriptions.get(0).createdOn, 'dd MMM yyyy')}">valid from: 17 OCT 2025</p>
                    <p th:text="'valid until: ' + ${#temporals.format(user.subscriptions.get(0).expirationOn, 'dd MMM yyyy')}">valid until: --</p>
                </div>
                <a th:href="@{'/subscriptions'}" class="btn change-subscription-button">
                    <p>Change Subscription</p>
                </a>
            </div>

        </div>
    </div>
</body>

</html>